---
applyTo: '**/*.go'
---

# Go プロジェクト コーディング標準

## 一般的なガイドライン

* すべてのGoコードは、Goの慣用的な規約に従ってください (https://go.dev/doc/effective_go)。
* すべてのGoコードは、`go fmt`と`go vet`の検証に合格する必要があります。
* モックとテストを可能にするために、依存関係にはインターフェースを優先してください。
* 不必要な抽象化を避け、物事をシンプルで読みやすく保ってください。

## コード構成

* 標準の Go プロジェクトレイアウト (`cmd/`, `internal/`, `pkg/`) を使用してください
* 関連する機能をパッケージにグループ化してください
* パッケージを集中させ、まとまりのあるものにしてください
* 意味のあるパッケージ名を使用してください (`utils`, `common` を避ける)。例えば、`auth`, `storage`, `userprofile` など、パッケージの責務や内容が明確に分かる名前を選んでください。

## 命名

* エクスポートされた関数、型、定数には **PascalCase** を使用してください
* エクスポートされていない関数、変数には **camelCase** を使用してください
* 定数には **SCREAMING_SNAKE_CASE** を使用してください
* 説明的な名前を使用してください (略語を避ける)

## エラー処理

* エラーは常に明示的に処理してください。
* 適切なエラー処理を使用し、`panic`の使用は避けてください。
* エラーは、`fmt.Errorf`を使用してラップし、コンテキストを提供してください。
* ドメイン固有のエラーにはカスタムエラー型を使用してください。
```go
// 常にエラーを明示的に処理する
if err != nil {
  return fmt.Errorf("failed to create user: %w", err)
}

// ドメインエラーにはカスタムエラー型を使用する
type ValidationError struct {
  Field   string
  Message string
}

func (e ValidationError) Error() string {
  return fmt.Sprintf("validation failed for %s: %s", e.Field, e.Message)
}
```

## ロギング

* ログの記録にはプロジェクトで定義されたロギングユーティリティを使用してください。

## テスト

* テストはテーブル駆動テストを使用して、複数のシナリオをテストしてください。
* テストを作成する際は、ロギングを初期化してください。そうしないと、ログが正しい場所に出力されない可能性があります。
* テストは並行して実行できるようにしてください。
* 単体テストは、mockを使用して外部依存関係をシミュレートしてください。
* コードには少なくとも80%以上の単体テストカバレッジが必要です（`go test -cover`で測定してください）。